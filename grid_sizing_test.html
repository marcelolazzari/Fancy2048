<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fancy2048 - Grid Sizing Fix Test</title>
  <link rel="stylesheet" href="styles/unified_styles_fixed.css">
  
  <style>
    .test-info {
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 20px;
      margin: 20px;
      border-radius: 12px;
      font-size: 14px;
      line-height: 1.5;
    }
    
    .test-info h2 {
      color: #ffcc00;
      margin: 0 0 15px 0;
      font-size: 1.2rem;
    }
    
    .test-info ul {
      margin: 10px 0;
      padding-left: 20px;
    }
    
    .test-info li {
      margin: 8px 0;
    }
    
    .test-button {
      background: linear-gradient(45deg, #4CAF50, #45a049);
      color: white;
      border: none;
      padding: 12px 20px;
      margin: 5px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
    }
    
    .test-button:active {
      transform: scale(0.95);
    }
    
    .size-selector {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin: 15px 0;
      flex-wrap: wrap;
    }
    
    .current-size {
      background: linear-gradient(45deg, #FF9800, #F57C00);
      color: white;
      padding: 8px 16px;
      border-radius: 20px;
      font-weight: 600;
      display: inline-block;
      margin: 10px 0;
    }
    
    iframe {
      width: 100%;
      height: 80vh;
      border: none;
      border-radius: 12px;
      margin-top: 10px;
    }
    
    .debug-info {
      background: rgba(30, 30, 30, 0.9);
      color: #00ff00;
      padding: 10px;
      margin: 10px 0;
      border-radius: 6px;
      font-family: monospace;
      font-size: 12px;
      white-space: pre-line;
      max-height: 200px;
      overflow-y: auto;
    }
  </style>
</head>
<body>
  <div class="test-info">
    <h2>🔧 Grid Sizing & Proportional Resize Test</h2>
    <p>This test verifies the improved grid sizing system for all board sizes:</p>
    
    <h3>✅ Fixed Issues:</h3>
    <ul>
      <li><strong>Proportional scaling</strong> - All grids now scale properly inside the container</li>
      <li><strong>Dynamic CSS variables</strong> - Board size, gaps, and fonts adjust automatically</li>
      <li><strong>Consistent aspect ratio</strong> - Perfect squares maintained at all sizes</li>
      <li><strong>Responsive font scaling</strong> - Text scales proportionally with tile size</li>
      <li><strong>Mobile optimization</strong> - Better sizing on all screen sizes</li>
    </ul>
    
    <h3>🎯 Grid Specifications:</h3>
    <ul>
      <li><strong>3x3 Grid:</strong> Larger tiles (450px max), wider gaps, bigger fonts</li>
      <li><strong>4x4 Grid:</strong> Balanced sizing (500px max), standard gaps</li>
      <li><strong>5x5 Grid:</strong> Compact tiles (520px max), tighter gaps, smaller fonts</li>
    </ul>
    
    <div class="size-selector">
      <button class="test-button" onclick="testGridSize(3)">Test 3x3 Grid</button>
      <button class="test-button" onclick="testGridSize(4)">Test 4x4 Grid</button>
      <button class="test-button" onclick="testGridSize(5)">Test 5x5 Grid</button>
      <button class="test-button" onclick="simulateResize()">Test Window Resize</button>
    </div>
    
    <div class="current-size" id="current-size">Current: 4x4 Grid (Default)</div>
    
    <div class="debug-info" id="debug-info">
Grid Size Test Ready...
Resize the window or click buttons above to test proportional scaling.
    </div>
  </div>

  <iframe src="pages/index.html" id="game-iframe" title="Fancy2048 Game with Fixed Grid Sizing"></iframe>

  <script>
    function updateDebugInfo() {
      const debugDiv = document.getElementById('debug-info');
      const currentSize = document.querySelector(':root').style.getPropertyValue('--size') || '4';
      
      const info = `
Current Grid Size: ${currentSize}x${currentSize}
Window Size: ${window.innerWidth} x ${window.innerHeight}px
Device Pixel Ratio: ${window.devicePixelRatio}x
Board Max Size: ${getComputedStyle(document.documentElement).getPropertyValue('--board-max-size')}
Tile Size: ${getComputedStyle(document.documentElement).getPropertyValue('--tile-size')}
Gap: ${getComputedStyle(document.documentElement).getPropertyValue('--gap')}
Font Scale Base: ${getComputedStyle(document.documentElement).getPropertyValue('--font-scale-base')}
User Agent: ${navigator.userAgent.substring(0, 60)}...
      `.trim();
      
      debugDiv.textContent = info;
    }
    
    function testGridSize(size) {
      const iframe = document.getElementById('game-iframe');
      const currentSizeDiv = document.getElementById('current-size');
      
      // Update the game in the iframe
      iframe.contentWindow.postMessage({
        type: 'changeGridSize',
        size: size
      }, '*');
      
      // Update the display
      currentSizeDiv.textContent = `Current: ${size}x${size} Grid`;
      
      // Update debug info
      setTimeout(updateDebugInfo, 100);
      
      console.log(`🎲 Testing ${size}x${size} grid`);
    }
    
    function simulateResize() {
      console.log('🔄 Simulating window resize...');
      
      // Trigger resize event
      window.dispatchEvent(new Event('resize'));
      
      // Update info after a moment
      setTimeout(() => {
        updateDebugInfo();
        console.log('📏 Window resize simulation complete');
      }, 300);
    }
    
    // Initial debug info
    window.addEventListener('load', () => {
      setTimeout(updateDebugInfo, 1000);
    });
    
    // Update debug info on resize
    let resizeTimeout;
    window.addEventListener('resize', () => {
      clearTimeout(resizeTimeout);
      resizeTimeout = setTimeout(updateDebugInfo, 300);
    });
    
    // Listen for messages from the iframe
    window.addEventListener('message', (event) => {
      if (event.data.type === 'gridSizeChanged') {
        const size = event.data.size;
        document.getElementById('current-size').textContent = `Current: ${size}x${size} Grid`;
        setTimeout(updateDebugInfo, 100);
      }
    });
    
    // Detect mobile
    const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    console.log('📱 Mobile device detected:', isMobile);
    
    // Log test info
    console.log('🔧 Grid Sizing Test Suite Ready');
    console.log('✅ Dynamic CSS variables system implemented');
    console.log('✅ Proportional scaling fixed for all grid sizes');
    console.log('✅ Mobile-responsive design optimized');
  </script>
</body>
</html>
