<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fancy2048 - Quick Fix Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #1a1a1a;
            color: #f2f2f2;
            text-align: center;
        }
        .test-box {
            background: #333;
            padding: 30px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .success { color: #4CAF50; }
        .error { color: #f44336; }
        .warning { color: #FF9800; }
        button {
            background: #ffcc00;
            color: #000;
            border: none;
            padding: 15px 30px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
            font-size: 16px;
        }
        button:hover { background: #e6b800; }
        #result {
            margin: 20px 0;
            padding: 15px;
            border-radius: 5px;
            min-height: 100px;
        }
    </style>
</head>
<body>
    <h1>üîß Fancy2048 Quick Fix Test</h1>
    
    <div class="test-box">
        <h2>GitHub Pages Status Check</h2>
        <p>This will test the current state of the deployed game.</p>
        <button onclick="runQuickTest()">üöÄ Run Quick Test</button>
        <button onclick="window.location.href='pages/index.html'">üéÆ Go to Main Game</button>
    </div>
    
    <div id="result" class="test-box"></div>
    
    <script>
        function runQuickTest() {
            const result = document.getElementById('result');
            result.innerHTML = '<h3>üîç Testing...</h3>';
            
            let html = '<h3>Test Results:</h3><ul style="text-align: left;">';
            
            // Test 1: Check if scripts can be loaded
            const gameScriptExists = typeof Game !== 'undefined';
            const advancedAIExists = typeof AdvancedAI2048Solver !== 'undefined';
            const enhancedAIExists = typeof Enhanced2048AI !== 'undefined';
            
            html += `<li ${gameScriptExists ? 'class="success"' : 'class="error"'}>
                ${gameScriptExists ? '‚úÖ' : '‚ùå'} Game class: ${gameScriptExists ? 'Available' : 'NOT FOUND'}
            </li>`;
            
            html += `<li ${advancedAIExists ? 'class="success"' : 'class="warning"'}>
                ${advancedAIExists ? '‚úÖ' : '‚ö†Ô∏è'} Advanced AI: ${advancedAIExists ? 'Available' : 'Missing'}
            </li>`;
            
            html += `<li ${enhancedAIExists ? 'class="success"' : 'class="warning"'}>
                ${enhancedAIExists ? '‚úÖ' : '‚ö†Ô∏è'} Enhanced AI: ${enhancedAIExists ? 'Available' : 'Missing'}
            </li>`;
            
            // Test 2: If Game exists, test if key methods are present
            if (gameScriptExists) {
                try {
                    const testGame = new Game(4);
                    const requiredMethods = ['initializeResizeObserver', 'debounce', 'updateAutoPlayButton', 'updateSpeedButton', 'getAutoPlayDelay', 'changeSpeed'];
                    let methodResults = [];
                    
                    requiredMethods.forEach(method => {
                        const exists = typeof testGame[method] === 'function';
                        methodResults.push({method, exists});
                        html += `<li ${exists ? 'class="success"' : 'class="error"'}>
                            ${exists ? '‚úÖ' : '‚ùå'} Method ${method}(): ${exists ? 'Present' : 'MISSING'}
                        </li>`;
                    });
                    
                    const allMethodsPresent = methodResults.every(r => r.exists);
                    
                    if (allMethodsPresent) {
                        html += '<li class="success">‚úÖ All required methods are present!</li>';
                        html += '<li class="success">üéâ Game should work correctly now</li>';
                    } else {
                        html += '<li class="error">‚ùå Some methods are missing - game may not initialize</li>';
                        html += '<li class="warning">‚ö†Ô∏è Need to push updated files to GitHub</li>';
                    }
                    
                } catch (error) {
                    html += `<li class="error">‚ùå Game initialization failed: ${error.message}</li>`;
                }
            } else {
                html += '<li class="error">‚ùå Cannot test methods - Game class not loaded</li>';
            }
            
            // Test 3: Environment check
            html += `<li class="info">‚ÑπÔ∏è Current URL: ${window.location.href}</li>`;
            html += `<li class="info">‚ÑπÔ∏è User Agent: ${navigator.userAgent.substring(0, 50)}...</li>`;
            html += `<li class="info">‚ÑπÔ∏è Local Storage Available: ${typeof Storage !== 'undefined' ? 'Yes' : 'No'}</li>`;
            
            html += '</ul>';
            
            // Add recommendation
            if (!gameScriptExists) {
                html += '<div class="error" style="margin-top: 20px; padding: 15px; border-radius: 5px;"><h4>‚ùå Critical Issue Found</h4><p>The Game class is not loading. This could be due to:</p><ul><li>GitHub Pages cache (try hard refresh: Ctrl+F5)</li><li>Old files on GitHub repository</li><li>Script loading errors</li></ul></div>';
            } else {
                const testGame = new Game(4);
                const hasAllMethods = ['initializeResizeObserver', 'debounce', 'updateAutoPlayButton'].every(method => typeof testGame[method] === 'function');
                
                if (hasAllMethods) {
                    html += '<div class="success" style="margin-top: 20px; padding: 15px; border-radius: 5px;"><h4>üéâ Everything Looks Good!</h4><p>All required methods are present. The game should be working correctly.</p></div>';
                } else {
                    html += '<div class="warning" style="margin-top: 20px; padding: 15px; border-radius: 5px;"><h4>‚ö†Ô∏è Partial Fix Needed</h4><p>Some methods are still missing. The fixes may not have been deployed yet. Try:</p><ul><li>Hard refresh (Ctrl+F5 or Cmd+Shift+R)</li><li>Wait a few minutes for GitHub Pages to update</li><li>Clear browser cache</li></ul></div>';
                }
            }
            
            result.innerHTML = html;
        }
        
        // Auto-run test when page loads
        window.addEventListener('load', () => {
            setTimeout(runQuickTest, 1000);
        });
        
        // Global error capture
        window.addEventListener('error', (e) => {
            console.error('Script error:', e.error);
        });
    </script>
    
    <!-- Load the game scripts to test them -->
    <script src="scripts/advanced_ai_solver.js" async></script>
    <script src="scripts/enhanced_ai.js" async></script>
    <script src="scripts/game.js" async></script>
</body>
</html>
