<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fancy2048 Integrity Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #1a1a1a;
            color: #f2f2f2;
        }
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border: 1px solid;
        }
        .pass {
            background: rgba(0, 255, 0, 0.1);
            border-color: #00ff00;
            color: #00ff00;
        }
        .fail {
            background: rgba(255, 0, 0, 0.1);
            border-color: #ff0000;
            color: #ff0000;
        }
        .info {
            background: rgba(0, 170, 255, 0.1);
            border-color: #00aaff;
            color: #00aaff;
        }
    </style>
</head>
<body>
    <h1>🔧 Fancy2048 Integrity Test</h1>
    <div id="test-results"></div>
    
    <script>
        const results = [];
        
        function addResult(message, status) {
            results.push({message, status});
            const div = document.createElement('div');
            div.className = `test-result ${status}`;
            div.textContent = message;
            document.getElementById('test-results').appendChild(div);
        }
        
        // Test 1: Check if all scripts are loaded
        addResult('🔍 Testing script loading...', 'info');
        
        setTimeout(() => {
            // Test AI Learning System
            if (typeof AILearningSystem !== 'undefined') {
                addResult('✅ AILearningSystem loaded successfully', 'pass');
                try {
                    const testLearning = new AILearningSystem();
                    addResult('✅ AILearningSystem can be instantiated', 'pass');
                } catch (e) {
                    addResult('❌ AILearningSystem instantiation failed: ' + e.message, 'fail');
                }
            } else {
                addResult('❌ AILearningSystem not found', 'fail');
            }
            
            // Test Advanced AI Solver
            if (typeof AdvancedAI2048Solver !== 'undefined') {
                addResult('✅ AdvancedAI2048Solver loaded successfully', 'pass');
            } else {
                addResult('❌ AdvancedAI2048Solver not found', 'fail');
            }
            
            // Test Enhanced AI
            if (typeof Enhanced2048AI !== 'undefined') {
                addResult('✅ Enhanced2048AI loaded successfully', 'pass');
            } else {
                addResult('❌ Enhanced2048AI not found', 'fail');
            }
            
            // Test Game class
            if (typeof Game !== 'undefined') {
                addResult('✅ Game class loaded successfully', 'pass');
            } else {
                addResult('❌ Game class not found', 'fail');
            }
            
            // Test window.game instance
            if (typeof window.game !== 'undefined' && window.game) {
                addResult('✅ Game instance created successfully', 'pass');
            } else {
                addResult('❌ Game instance not found', 'fail');
            }
            
            // Test DOM elements
            const requiredElements = [
                'board-container', 'score', 'best-score', 'moves', 'time',
                'changeColor-button', 'leaderboard-button', 'export-stats-button',
                'back-button', 'pause-button', 'board-size-button',
                'theme-toggle-button', 'autoplay-button', 'speed-button',
                'reset-button', 'ai-difficulty-button'
            ];
            
            let missingElements = 0;
            requiredElements.forEach(id => {
                if (document.getElementById(id)) {
                    // Element found - no message for success to keep output clean
                } else {
                    addResult(`❌ Missing DOM element: ${id}`, 'fail');
                    missingElements++;
                }
            });
            
            if (missingElements === 0) {
                addResult('✅ All required DOM elements present', 'pass');
            }
            
            // Final summary
            const passCount = results.filter(r => r.status === 'pass').length;
            const failCount = results.filter(r => r.status === 'fail').length;
            
            addResult(`📊 Test Summary: ${passCount} passed, ${failCount} failed`, failCount === 0 ? 'pass' : 'fail');
            
            if (failCount === 0) {
                addResult('🎉 All integrity tests passed! Game should work correctly.', 'pass');
            } else {
                addResult('⚠️ Some tests failed. Game may have issues.', 'fail');
            }
        }, 1000);
    </script>
    
    <!-- Load the same scripts as the main game -->
    <script src="scripts/ai_learning_system.js"></script>
    <script src="scripts/advanced_ai_solver.js"></script>
    <script src="scripts/enhanced_ai.js"></script>
    <!-- We need a minimal HTML structure for game.js -->
    <div style="display: none;">
        <div id="board-container"></div>
        <span id="score">0</span>
        <span id="best-score">0</span>
        <span id="moves">0</span>
        <span id="time">00:00</span>
        <button id="changeColor-button"></button>
        <button id="leaderboard-button"></button>
        <button id="export-stats-button"></button>
        <button id="back-button"></button>
        <button id="pause-button"></button>
        <button id="board-size-button"></button>
        <button id="theme-toggle-button"></button>
        <button id="autoplay-button"></button>
        <button id="speed-button"><span class="speed-text">1x</span></button>
        <button id="reset-button"></button>
        <button id="ai-difficulty-button"><span class="button-text">Normal</span></button>
    </div>
    <script src="scripts/game.js"></script>
</body>
</html>
